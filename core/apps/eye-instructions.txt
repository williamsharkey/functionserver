# Eye Bridge - Direct Browser JS Access

You have access to a live browser session via the `eye` CLI tool or `eye-mcp` MCP server.

## Setup (one time)
```bash
mkdir -p ~/.algo
cat > ~/.algo/config.json << 'EOF'
{{CONFIG}}
EOF
go install github.com/williamsharkey/functionserver/go/cmd/eye@latest
# Or: cd functionserver/go && go build -o /usr/local/bin/eye ./cmd/eye/
```

## Usage
```bash
eye 'a:document.title'              # Get page title
eye 'a:1+1'                         # Evaluate expression
eye 'console.log("hi")'             # Fire and forget (no id: prefix)
eye                                 # Interactive REPL mode
```

## Browser Shortcuts

Terse helpers available in the browser:
```javascript
$(sel)     // document.querySelector(sel)
$$(sel)    // [...document.querySelectorAll(sel)]
apps()     // systemApps.map(a => a.name)
wins()     // windows.map(w => ({id, title, app}))
```

## Key APIs
```javascript
// Desktop state
ALGO.bridge.getState()              // {windows, apps, user, activeWindow}
apps()                              // List all app names (shortcut)
wins()                              // List open windows (shortcut)

// Window control
ALGO.bridge.openApp("shell")        // Open app by name
ALGO.bridge.closeWindow(id)         // Close window
ALGO.bridge.focusWindow(id)         // Bring to front

// DOM access
$(sel)                              // Query single element
$$(sel)                             // Query all elements

// Storage
localStorage.getItem(key)           // Read persistent data
localStorage.setItem(key, value)    // Write persistent data
```

## Examples
```bash
# List all system apps
eye 'a:apps()'

# Get all window info
eye 'a:wins()'

# Open an app
eye 'ALGO.bridge.openApp("shell")'

# Inject CSS
eye '$("body").style.background="red"'

# Query element position
eye 'a:JSON.stringify($(".menu").getBoundingClientRect())'
```

## MCP Server (for Claude Code)

For faster access (3x speedup), use the MCP server:
```bash
# Build
go build -o eye-mcp ./cmd/eye-mcp/

# Register with Claude Code
claude mcp add --transport stdio eye -- /path/to/eye-mcp
```

Then use the `eye` tool directly in Claude Code without Bash wrapper.

## Protocol
- `expression` = fire and forget (no response)
- `id:expression` = get response as `id:result` or `id!:error`
- Connection: WebSocket at {{SERVER}}
